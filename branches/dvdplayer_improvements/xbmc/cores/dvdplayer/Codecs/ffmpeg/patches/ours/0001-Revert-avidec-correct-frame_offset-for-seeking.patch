From 04460006f42c76ff77466dbbb4c7895a9f7f1fba Mon Sep 17 00:00:00 2001
From: Jools Wills <jools@oxfordinspire.co.uk>
Date: Sun, 12 Jun 2011 00:10:46 +0100
Subject: [PATCH 1/3] Revert "avidec: correct frame_offset for seeking"

This reverts commit 187528441ab936c102b8e72f38925cc10fc14abc.
---
 libavformat/avidec.c |   16 ----------------
 1 files changed, 0 insertions(+), 16 deletions(-)

diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index 3968649..2491687 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -1364,22 +1364,6 @@ static int avi_read_seek(AVFormatContext *s, int stream_index, int64_t timestamp
             index=0;
         ast2->seek_pos= st2->index_entries[index].pos;
         pos_min= FFMIN(pos_min,ast2->seek_pos);
-    }
-    for(i = 0; i < s->nb_streams; i++) {
-        AVStream *st2 = s->streams[i];
-        AVIStream *ast2 = st2->priv_data;
-
-        if (ast2->sub_ctx || st2->nb_index_entries <= 0)
-            continue;
-
-        index = av_index_search_timestamp(
-                st2,
-                av_rescale_q(timestamp, st->time_base, st2->time_base) * FFMAX(ast2->sample_size, 1),
-                flags | AVSEEK_FLAG_BACKWARD);
-        if(index<0)
-            index=0;
-        while(index>0 && st2->index_entries[index-1].pos >= pos_min)
-            index--;
         ast2->frame_offset = st2->index_entries[index].timestamp;
     }
 
-- 
1.7.4.1

