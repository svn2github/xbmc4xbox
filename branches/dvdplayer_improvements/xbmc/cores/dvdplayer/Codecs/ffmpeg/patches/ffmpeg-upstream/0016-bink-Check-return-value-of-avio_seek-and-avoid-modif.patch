From 598cc84fbf137df57b5e273484083606583ec3e8 Mon Sep 17 00:00:00 2001
From: Joakim Plate <elupus@ecce.se>
Date: Wed, 14 Sep 2011 19:23:39 +0200
Subject: [PATCH 16/34] [bink] Check return value of avio_seek and avoid
 modifying state if it fails

---
 libavformat/bink.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/libavformat/bink.c b/libavformat/bink.c
index a54765a..3cd82ac 100644
--- a/libavformat/bink.c
+++ b/libavformat/bink.c
@@ -256,7 +256,9 @@ static int read_seek(AVFormatContext *s, int stream_index, int64_t timestamp, in
         return -1;
 
     /* seek to the first frame */
-    avio_seek(s->pb, vst->index_entries[0].pos, SEEK_SET);
+    if (avio_seek(s->pb, vst->index_entries[0].pos, SEEK_SET) < 0)
+        return -1;
+
     bink->video_pts = 0;
     memset(bink->audio_pts, 0, sizeof(bink->audio_pts));
     bink->current_track = -1;
-- 
1.7.5.4

