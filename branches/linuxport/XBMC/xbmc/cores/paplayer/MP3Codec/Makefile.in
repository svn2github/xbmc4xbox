compile: MADCodec-@ARCH@.so

MADCodec-@ARCH@.so: libmad-compile MADCodec/MadMp3Decoder.o
	gcc -shared -o $@  MADCodec/MadMp3Decoder.o libmad-0.15.1b/.libs/libmad.a `cat ../../DllLoader/exports/wrapper.def` ../../DllLoader/exports/wrapper.o -fPIC -O3 && cp $@ ../../../../system/players/paplayer/

libmad-compile:
	$(MAKE) -C libmad-0.15.1b
	
MADCodec/MadMp3Decoder.o: MADCodec/MadMp3Decoder.cpp libmad-compile
	g++ -o $@ -c $< -Ilibmad-0.15.1b -D_LINUX -fPIC -O3

clean:
	$(MAKE) -C libmad-0.15.1b clean
	$(RM) MADCodec/MadMp3Decoder.o
	$(RM) MADCodec-i486-linux.so

distclean: clean
	$(MAKE) -C libmad-0.15.1b distclean

